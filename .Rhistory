drop_na(teen_preg_and_abort)
drop_na(summary_info)
View(summary_info)
View(teen_preg_and_abort)
aggregate_table <- summary_info %>%
group_by(sex_ed) %>%
select(state_id, sex_ed, abortionrate, pregnancy_rate, total_contraceptives)
View(aggregate_table)
teen_preg <- read.csv("data/teen_preg_2016.csv")
requirement_level <- read.csv("data/state_level_requirement.csv")
abortions <- read.csv("data/NationalandStatePregnancy.csv")
contraceptives <- read.csv("data/contraceptives.csv")
# only want 2016
abortions <- filter(
abortions,
year == "2016"
)
# prepare to join
teen_abort <- full_join(abortions, requirement_level)
teen_abort <- teen_abort %>%
mutate(state_id = tolower(state_id)) %>%
mutate(state = tolower(state))
contraceptives <- contraceptives %>%
mutate(state = tolower(state)) %>%
rename("state_id" = "state")
teen_preg <- teen_preg %>%
mutate(state_id = tolower(state_id))
# combine abortions with teen pregnancies
teen_preg_and_abort <- (left_join(teen_preg, teen_abort))
summary_info <- (left_join(teen_preg_and_abort, contraceptives))
drop_na(teen_preg_and_abort)
drop_na(summary_info)
# group the data by sex ed category
aggregate_table <- summary_info %>%
group_by(sex_ed) %>%
select(state_id, sex_ed, abortionrate, pregnancy_rate, total_contraceptives)
teen_preg_and_abort <- (left_join(teen_preg, teen_abort))
summary_info <- (left_join(teen_preg_and_abort, contraceptives))
teen_preg_and_abort <- drop_na(teen_preg_and_abort)
summary_info <- drop_na(summary_info)
# group the data by sex ed category
aggregate_table <- summary_info %>%
group_by(sex_ed) %>%
select(state_id, sex_ed, abortionrate, pregnancy_rate, total_contraceptives)
View(aggregate_table)
teen_preg_and_abort <- na.omit(left_join(teen_preg, teen_abort))
summary_info <- na.omit(left_join(teen_preg_and_abort, contraceptives))
teen_preg_and_abort <- na.omit(left_join(teen_preg, teen_abort))
summary_info <- na.omit(left_join(teen_preg_and_abort, contraceptives))
# group the data by sex ed category
aggregate_table <- summary_info %>%
group_by(sex_ed) %>%
select(state_id, sex_ed, abortionrate, pregnancy_rate, total_contraceptives)
View(aggregate_table)
teen_preg_and_abort <-left_join(teen_preg, teen_abort)
summary_info <- left_join(teen_preg_and_abort, contraceptives)
# group the data by sex ed category
aggregate_table <- summary_info %>%
group_by(sex_ed) %>%
select(state_id, sex_ed, abortionrate, pregnancy_rate, total_contraceptives)
View(aggregate_table)
teen_preg <- read.csv("data/teen_preg_2016.csv")
requirement_level <- read.csv("data/state_level_requirement.csv")
abortions <- read.csv("data/NationalandStatePregnancy.csv")
contraceptives <- read.csv("data/contraceptives.csv")
# only want 2016
abortions <- filter(
abortions,
year == "2016"
)
# prepare to join
teen_abort <- full_join(abortions, requirement_level)
teen_abort <- teen_abort %>%
mutate(state_id = tolower(state_id)) %>%
mutate(state = tolower(state))
contraceptives <- contraceptives %>%
mutate(state = tolower(state)) %>%
rename("state_id" = "state")
teen_preg <- teen_preg %>%
mutate(state_id = tolower(state_id))
# combine abortions with teen pregnancies
teen_preg_and_abort <-left_join(teen_preg, teen_abort)
summary_info <- left_join(teen_preg_and_abort, contraceptives)
# group the data by sex ed category
aggregate_table <- summary_info %>%
group_by(sex_ed) %>%
select(state_id, sex_ed, abortionrate, pregnancy_rate, total_contraceptives)
View(aggregate_table)
View(teen_preg_and_abort)
View(teen_preg)
View(teen_abort)
teen_preg_and_abort <- left_join(teen_preg, teen_abort)
View(teen_preg_and_abort)
teen_preg_and_abort <- full_join(teen_preg, teen_abort)
View(teen_preg_and_abort)
teen_preg <- teen_preg %>%
mutate(state_id = tolower(state_id)) %>%
mutate(state = tolower(state))
# combine abortions with teen pregnancies
teen_preg_and_abort <- full_join(teen_preg, teen_abort)
summary_info <- left_join(teen_preg_and_abort, contraceptives)
View(teen_preg_and_abort)
View(summary_info)
# import data
teen_preg <- read.csv("data/teen_preg_2016.csv")
requirement_level <- read.csv("data/state_level_requirement.csv")
abortions <- read.csv("data/NationalandStatePregnancy.csv")
contraceptives <- read.csv("data/contraceptives.csv")
# only want 2016
abortions <- filter(
abortions,
year == "2016"
)
# prepare to join
teen_abort <- full_join(abortions, requirement_level)
teen_abort <- teen_abort %>%
mutate(state_id = tolower(state_id)) %>%
mutate(state = tolower(state))
contraceptives <- contraceptives %>%
mutate(state = tolower(state)) %>%
rename("state_id" = "state")
teen_preg <- teen_preg %>%
mutate(state_id = tolower(state_id)) %>%
mutate(state = tolower(state))
# combine abortions with teen pregnancies
teen_preg_and_abort <- full_join(teen_preg, teen_abort)
summary_info <- left_join(teen_preg_and_abort, contraceptives)
# group the data by sex ed category
aggregate_table <- summary_info %>%
group_by(sex_ed) %>%
select(state_id, sex_ed, abortionrate, pregnancy_rate, total_contraceptives)
View(aggregate_table)
teen_abort_map
View(teen_abort)
contraceptives <- read.csv("data/contraceptives.csv")
contraceptive_table <- contraceptives %>%
select(state, total_contraceptives, sex_ed)
contraceptive_plot <- ggplot(contraceptive_table) +
geom_point(mapping = aes(x = state, y = total_contraceptives, fill = sex_ed )) +
labs(x = "State",
y = "Percent of Women Who Use Contraceptives",
fill = "Level of Sexual Education") +
ggtitle("United States 2016 Contraceptive Use") +
theme(axis.text.x = element_text(angle = 90))
contraceptive_chart <- ggplotly(contraceptive_plot)
contraceptive_chart
teen_pregnancy_2016 <- read.csv("data/teen_preg_2016.csv")
teen_preg <- (teen_pregnancy_2016) %>%
group_by(sex_ed) %>%
select(state, state_id, pregnancy_rate, sex_ed)
teen_preg_chart <- ggplot(teen_preg) +
geom_col(mapping = aes(
x = reorder(state_id, pregnancy_rate), y = pregnancy_rate, fill = sex_ed)) +
labs(x = "State", y = "Pregnancy Rate", fill = "Level of Sexual Education") +
ggtitle("United States 2016 Teen Pregnancy by State ") +
coord_flip()
teen_preg_chart
requirement_level <- read.csv("data/state_level_requirement.csv")
abortions <- read.csv("data/NationalandStatePregnancy.csv")
abortions <- filter(
abortions,
year == "2016"
)
teen_abort <- full_join(abortions, requirement_level)
teen_abort <- teen_abort %>%
mutate(state = tolower(state))
state_shape <- map_data("state") %>%
rename(state = region) %>%
full_join(teen_abort, by="state")
blank_theme <- theme_bw() +
theme(
axis.line = element_blank(), # remove axis lines
axis.text = element_blank(), # remove axis labels
axis.ticks = element_blank(), # remove axis ticks
axis.title = element_blank(), # remove axis titles
plot.background = element_blank(), # remove gray background
panel.grid.major = element_blank(), # remove major grid lines
panel.grid.minor = element_blank(), # remove minor grid lines
panel.border = element_blank() # remove border around plot
)
teen_abort_map <- ggplot(state_shape) +
geom_polygon(
mapping = aes(
x = long, y = lat, group = group, fill = abortionrate),
color = "white",
size = .1
) +
coord_map() +
blank_theme +
scale_fill_continuous(low = "slategray2", high = "mediumorchid2") +
labs(fill = "Abortion Rate") +
ggtitle("United States 2016 Teen Abortion")
teen_abort_map
contraceptives <- read.csv("data/contraceptives.csv")
contraceptive_table <- contraceptives %>%
select(state, total_contraceptives, sex_ed)
contraceptive_plot <- ggplot(contraceptive_table) +
geom_point(mapping = aes(x = state, y = total_contraceptives, fill = sex_ed )) +
labs(x = "State",
y = "Percent of Women Who Use Contraceptives",
fill = "Level of Sexual Education") +
ggtitle("United States 2016 Contraceptive Use") +
theme(axis.text.x = element_text(angle = 90))
contraceptive_chart <- ggplotly(contraceptive_plot)
contraceptive_chart
contraceptives <- read.csv("data/contraceptives.csv")
contraceptive_table <- contraceptives %>%
select(state, total_contraceptives, sex_ed)
contraceptive_plot <- ggplot(contraceptive_table) +
geom_point(mapping = aes(x = state, y = total_contraceptives, fill = sex_ed )) +
labs(x = "State",
y = "Percent of Women (age 15-49) Who Use Contraceptives",
fill = "Level of Sexual Education") +
ggtitle("United States 2016 Contraceptive Use") +
theme(axis.text.x = element_text(angle = 90))
contraceptive_chart <- ggplotly(contraceptive_plot)
contraceptive_chart
contraceptive_plot <- ggplot(contraceptive_table) +
geom_point(mapping = aes(x = state, y = total_contraceptives, fill = sex_ed )) +
labs(x = "State",
y = "Percent of Women Who Use Contraceptives (age 15-49)",
fill = "Level of Sexual Education") +
ggtitle("United States 2016 Contraceptive Use") +
theme(axis.text.x = element_text(angle = 90))
contraceptive_chart <- ggplotly(contraceptive_plot)
contraceptive_chart
contraceptive_plot <- ggplot(contraceptive_table) +
geom_point(mapping = aes(x = state, y = total_contraceptives, fill = sex_ed )) +
labs(x = "State",
y = "Percent of Women Who Use Contraceptives (age 15-49)",
fill = "Level of
Sexual Education") +
ggtitle("United States 2016 Contraceptive Use") +
theme(axis.text.x = element_text(angle = 90))
contraceptive_chart <- ggplotly(contraceptive_plot)
contraceptive_chart
contraceptive_plot <- ggplot(contraceptive_table) +
geom_point(mapping = aes(x = state, y = total_contraceptives, fill = sex_ed )) +
labs(x = "State",
y = "Percent of Women Who Use Contraceptives (age 15-49)",
fill = "Level of
Sexual Education") +
theme(legend.position = (bottom))
ggtitle("United States 2016 Contraceptive Use") +
theme(axis.text.x = element_text(angle = 90))
contraceptive_chart <- ggplotly(contraceptive_plot)
contraceptive_chart
contraceptive_plot <- ggplot(contraceptive_table) +
geom_point(mapping = aes(x = state, y = total_contraceptives, fill = sex_ed )) +
labs(x = "State",
y = "Percent of Women Who Use Contraceptives (age 15-49)",
fill = "Level of
Sexual
Education") +
theme(legend.position = (bottom))
ggtitle("United States 2016 Contraceptive Use") +
theme(axis.text.x = element_text(angle = 90))
contraceptive_chart
contraceptive_plot <- ggplot(contraceptive_table) +
geom_point(mapping = aes(x = state, y = total_contraceptives, fill = sex_ed )) +
labs(x = "State",
y = "Percent of Women Who Use Contraceptives (age 15-49)",
fill = "Sexual
Education") +
ggtitle("United States 2016 Contraceptive Use") +
theme(axis.text.x = element_text(angle = 90))
contraceptive_chart <- ggplotly(contraceptive_plot)
contraceptive_chart
contraceptive_plot <- ggplot(contraceptive_table) +
geom_point(mapping = aes(x = state, y = total_contraceptives, fill = sex_ed )) +
labs(x = "State",
y = "Percent of Women Who Use Contraceptives (age 15-49)",
fill = "Sexual
Education") +
theme(legend.position = c(0.5, 0.5)) +
ggtitle("United States 2016 Contraceptive Use") +
theme(axis.text.x = element_text(angle = 90))
contraceptive_chart <- ggplotly(contraceptive_plot)
contraceptive_chart
contraceptive_plot <- ggplot(contraceptive_table) +
geom_point(mapping = aes(x = state, y = total_contraceptives, fill = sex_ed )) +
labs(x = "State",
y = "Percent of Women Who Use Contraceptives (age 15-49)",
fill = "Sexual
Education") +
theme(legend.position = c(-5, 0)) +
ggtitle("United States 2016 Contraceptive Use") +
theme(axis.text.x = element_text(angle = 90))
contraceptive_chart <- ggplotly(contraceptive_plot)
contraceptive_chart
contraceptive_plot <- ggplot(contraceptive_table) +
geom_point(mapping = aes(x = state, y = total_contraceptives, fill = sex_ed )) +
labs(x = "State",
y = "Percent of Women Who Use Contraceptives (age 15-49)",
fill = "Sexual
Education") +
theme(legend.position = c(-5, -5)) +
ggtitle("United States 2016 Contraceptive Use") +
theme(axis.text.x = element_text(angle = 90))
contraceptive_chart <- ggplotly(contraceptive_plot)
contraceptive_chart
contraceptive_plot <- ggplot(contraceptive_table) +
geom_point(mapping = aes(x = state, y = total_contraceptives, fill = sex_ed )) +
theme(legend.position = c(-5, -5)) +
labs(x = "State",
y = "Percent of Women Who Use Contraceptives (age 15-49)",
fill = "Sexual
Education") +
ggtitle("United States 2016 Contraceptive Use") +
theme(axis.text.x = element_text(angle = 90))
contraceptive_chart <- ggplotly(contraceptive_plot)
contraceptive_chart
contraceptive_plot <- ggplot(contraceptive_table) +
geom_point(mapping = aes(x = state, y = total_contraceptives, fill = sex_ed )) +
labs(x = "State",
y = "Percent of Women Who Use Contraceptives (age 15-49)",
fill = "Sex Ed") +
ggtitle("United States 2016 Contraceptive Use") +
theme(axis.text.x = element_text(angle = 90))
contraceptive_chart <- ggplotly(contraceptive_plot)
contraceptive_chart
contraceptive_chart <- ggplotly(contraceptive_plot)
contraceptive_plot <- ggplot(contraceptive_table) +
geom_point(mapping = aes(x = state, y = total_contraceptives, fill = sex_ed )) +
labs(x = "State",
y = "Percent of Women Who Use Contraceptives (age 15-49)",
fill = "Sexual Education") +
ggtitle("United States 2016 Contraceptive Use") +
theme(axis.text.x = element_text(angle = 90))
contraceptive_chart <- ggplotly(contraceptive_plot)
contraceptive_chart
contraceptive_plot <- ggplot(contraceptive_table) +
geom_point(mapping = aes(x = state, y = total_contraceptives, fill = sex_ed )) +
labs(x = "State",
y = "Percent of Women Who Use Contraceptives (age 15-49)",
fill = "Sex Education") +
ggtitle("United States 2016 Contraceptive Use") +
theme(axis.text.x = element_text(angle = 90))
contraceptive_chart <- ggplotly(contraceptive_plot)
contraceptive_chart
contraceptive_plot <- ggplot(contraceptive_table) +
geom_point(mapping = aes(x = state, y = total_contraceptives, fill = sex_ed )) +
labs(x = "State",
y = "Percent of Women Who Use Contraceptives (age 15-49)",
fill = "Sex
Education") +
ggtitle("United States 2016 Contraceptive Use") +
theme(axis.text.x = element_text(angle = 90))
contraceptive_chart <- ggplotly(contraceptive_plot)
contraceptive_chart
contraceptive_plot <- ggplot(contraceptive_table) +
geom_point(mapping = aes(x = state, y = total_contraceptives, fill = sex_ed )) +
labs(x = "State",
y = "Percent of Women Who Use Contraceptives (age 15-49)",
fill = "Sex Ed") +
ggtitle("United States 2016 Contraceptive Use") +
theme(axis.text.x = element_text(angle = 90))
contraceptive_chart <- ggplotly(contraceptive_plot)
contraceptive_chart
teen_abort_map <- ggplot(state_shape) +
geom_polygon(
mapping = aes(
x = long, y = lat, group = group, fill = abortionrate),
color = "white",
size = .1
) +
coord_map() +
blank_theme +
scale_fill_continuous(low = "slategray2", high = "mediumorchid2") +
labs(fill = "Abortion Rate") +
ggtitle("United States 2016 Teen Abortion (age 15-19)")
teen_abort_map
teen_preg_chart <- ggplot(teen_preg) +
geom_col(mapping = aes(
x = reorder(state_id, pregnancy_rate), y = pregnancy_rate, fill = sex_ed)) +
labs(x = "State", y = "Pregnancy Rate (age 15-19)", fill = "Level of Sexual Education") +
ggtitle("United States 2016 Teen Pregnancy by State") +
coord_flip()
teen_preg_chart
aggregate_table <- summary_info %>%
group_by(sex_ed) %>%
rename("state_id" = "State") %>%
rename("sex_ed" = "Sexual Education") %>%
rename("abortionrate" = "Abortion Rate") %>%
rename("pregnancy_rate" = "Pregnancy Rate") %>%
rename("total_contraceptives" = " Percentage of Total Contraceptive Use")
select(state_id, sex_ed, abortionrate, pregnancy_rate, total_contraceptives)
aggregate_table <- summary_info %>%
group_by(sex_ed) %>%
rename("state" = "State") %>%
rename("sex_ed" = "Sexual Education") %>%
rename("abortionrate" = "Abortion Rate") %>%
rename("pregnancy_rate" = "Pregnancy Rate") %>%
rename("total_contraceptives" = " Percentage of Total Contraceptive Use")
select(state_id, sex_ed, abortionrate, pregnancy_rate, total_contraceptives)
# group the data by sex ed category
aggregate_table <- summary_info %>%
group_by(sex_ed) %>%
rename("state" = "State") %>%
rename("sex_ed" = "Sexual Education") %>%
rename("abortionrate" = "Abortion Rate") %>%
rename("pregnancy_rate" = "Pregnancy Rate") %>%
rename("total_contraceptives" = " Percentage of Total Contraceptive Use")
select(state, sex_ed, abortionrate, pregnancy_rate, total_contraceptives)
View(summary_info)
aggregate_table <- summary_info %>%
group_by(sex_ed) %>%
rename("state_id" = "State") %>%
rename("sex_ed" = "Sexual Education") %>%
rename("abortionrate" = "Abortion Rate") %>%
rename("pregnancy_rate" = "Pregnancy Rate") %>%
rename("total_contraceptives" = " Percentage of Total Contraceptive Use")
select(state_id, sex_ed, abortionrate, pregnancy_rate, total_contraceptives)
aggregate_table <- summary_info %>%
group_by(sex_ed) %>%
rename("State" = "state_id") %>%
rename("sex_ed" = "Sexual Education") %>%
rename("abortionrate" = "Abortion Rate") %>%
rename("pregnancy_rate" = "Pregnancy Rate") %>%
rename("total_contraceptives" = " Percentage of Total Contraceptive Use")
select(state_id, sex_ed, abortionrate, pregnancy_rate, total_contraceptives)
aggregate_table <- summary_info %>%
group_by(sex_ed) %>%
rename("State" = "state_id") %>%
rename("Sexual Education" = "sex_ed") %>%
rename("Abortion Rate" = "abortionrate") %>%
rename("Pregnancy Rate" = "pregnancy_rate") %>%
rename("Percentage of Total Contraceptive Use" = "total_contraceptives")
select(state_id, sex_ed, abortionrate, pregnancy_rate, total_contraceptives)
aggregate_table <- summary_info %>%
group_by(sex_ed) %>%
rename("State" = "state_id") %>%
rename("Sexual Education" = "sex_ed") %>%
rename("Abortion Rate" = "abortionrate") %>%
rename("Pregnancy Rate" = "pregnancy_rate") %>%
rename("Percentage of Total Contraceptive Use" = "total_contraceptives")
select(State, sex_ed, abortionrate, pregnancy_rate, total_contraceptives)
aggregate_table <- summary_info %>%
group_by(sex_ed) %>%
rename("State" = "state_id") %>%
rename("Sexual Education" = "sex_ed") %>%
rename("Abortion Rate" = "abortionrate") %>%
rename("Pregnancy Rate" = "pregnancy_rate") %>%
rename("Percentage of Total Contraceptive Use" = "total_contraceptives")
select(State, Sexual Education, Abortion Rate, Pregnancy Rate,
Percentage of Total Contraceptive Use)
aggregate_table <- summary_info %>%
group_by(sex_ed) %>%
rename("State" = "state_id") %>%
rename("Sexual Education" = "sex_ed") %>%
rename("Abortion Rate" = "abortionrate") %>%
rename("Pregnancy Rate" = "pregnancy_rate") %>%
rename("Percentage of Total Contraceptive Use" = "total_contraceptives")
select(State)
aggregate_table <- summary_info %>%
group_by(sex_ed) %>%
rename("State" = "state_id") %>%
rename("Sexual Education" = "sex_ed") %>%
rename("Abortion Rate" = "abortionrate") %>%
rename("Pregnancy Rate" = "pregnancy_rate") %>%
rename("Percentage of Total Contraceptive Use" = "total_contraceptives") %>%
select(State)
View(aggregate_table)
aggregate_table <- summary_info %>%
group_by(sex_ed) %>%
rename("State" = "state_id") %>%
rename("Sexual Education" = "sex_ed") %>%
rename("Abortion Rate" = "abortionrate") %>%
rename("Pregnancy Rate" = "pregnancy_rate") %>%
rename("Percentage of Total Contraceptive Use" = "total_contraceptives") %>%
select(State, Sexual Education, Abortion Rate, Pregnancy Rate,
Percentage of Total Contraceptive Use)
aggregate_table <- summary_info %>%
group_by(sex_ed) %>%
select(State, Sexual Education, Abortion Rate, Pregnancy Rate,
Percentage of Total Contraceptive Use)
rename("State" = "state_id") %>%
rename("Sexual Education" = "sex_ed") %>%
rename("Abortion Rate" = "abortionrate") %>%
rename("Pregnancy Rate" = "pregnancy_rate") %>%
rename("Percentage of Total Contraceptive Use" = "total_contraceptives")
aggregate_table <- summary_info %>%
group_by(sex_ed) %>%
select(state_id, sex_ed, abortionrate, pregnancy_rate,
total_contraceptives) %>%
rename("State" = "state_id") %>%
rename("Sexual Education" = "sex_ed") %>%
rename("Abortion Rate" = "abortionrate") %>%
rename("Pregnancy Rate" = "pregnancy_rate") %>%
rename("Percentage of Total Contraceptive Use" = "total_contraceptives")
View(aggregate_table)
aggregate_table <- summary_info %>%
group_by(sex_ed) %>%
mutate(state_id = toupper(state_id))
select(state_id, sex_ed, abortionrate, pregnancy_rate,
total_contraceptives) %>%
rename("State" = "state_id") %>%
rename("Sexual Education" = "sex_ed") %>%
rename("Abortion Rate" = "abortionrate") %>%
rename("Pregnancy Rate" = "pregnancy_rate") %>%
rename("Percentage of Total Contraceptive Use" = "total_contraceptives")
aggregate_table <- summary_info %>%
group_by(sex_ed) %>%
mutate(state_id = toupper(state_id)) %>%
select(state_id, sex_ed, abortionrate, pregnancy_rate,
total_contraceptives) %>%
rename("State" = "state_id") %>%
rename("Sexual Education" = "sex_ed") %>%
rename("Abortion Rate" = "abortionrate") %>%
rename("Pregnancy Rate" = "pregnancy_rate") %>%
rename("Percentage of Total Contraceptive Use" = "total_contraceptives")
contraceptive_chart
